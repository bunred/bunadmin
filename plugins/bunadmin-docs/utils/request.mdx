# Request

``` ts
import { ENV, request, storedToken } from "@bunred/bunadmin"
//...
const token = await storedToken()
const res = await request(url || "/graphql", {
  prefix: prefix || ENV.MAIN_URL,
  method: "POST",
  headers: headers || { token },
  data: JSON.stringify({ query, variables, operationName })
})
```

## Request options

| Parameter           | Description                                                      | Type                      | Optional Value                    | Default                    |
| :------------------ | :--------------------------------------------------------------- | :------------------------ | :-------------------------------- | :------------------------- |
| method              | request method                                                   | string                    | get , post , put ...              | get                        |
| params              | url request parameters                                           | object or URLSearchParams | --                                | --                         |
| data                | Submitted data                                                   | any                       | --                                | --                         |
| headers             | fetch original parameters                                        | object                    | --                                | {}                         |
| timeout             | timeout, default millisecond, write with caution                 | number                    | --                                | --                         |
| prefix              | prefix, generally used to override the uniform settings prefix   | string                    | --                                | --                         |
| suffix              | suffix, such as some scenes api need to be unified .json         | string                    | --                                |
| credentials         | fetch request with cookies                                       | string                    | --                                | credentials: 'same-origin' |
| useCache            | Whether to use caching (only support browser environment)        | boolean                   | --                                | false                      |
| validateCache       | cache strategy function                                          | (url, options) => boolean | --                                | only get request to cache  |
| ttl                 | Cache duration, 0 is not expired                                 | number                    | --                                | 60000                      |
| maxCache            | Maximum number of caches                                         | number                    | --                                | 0(Infinity)                |
| requestType         | post request data type                                           | string                    | json , form                       | json                       |
| parseResponse       | response processing simplification                               | boolean                   | --                                | true                       |
| charset             | character set                                                    | string                    | utf8 , gbk                        | utf8                       |
| responseType        | How to parse the returned data                                   | string                    | json , text , blob , formData ... | json , text                |
| throwErrIfParseFail | throw error when JSON parse fail and responseType is 'json'      | boolean                   | --                                | false                      |
| getResponse         | Whether to get the source response, the result will wrap a layer | boolean                   | --                                | fasle                      |
| errorHandler        | exception handling, or override unified exception handling       | function(error)           | --                                |
| cancelToken         | Token to cancel request                                          | CancelToken.token         | --                                | --                         |

The other parameters of fetch are valid. See [fetch documentation](https://github.github.io/fetch/)

## Extend options

| Parameter | Description            | Type   | Optional Value       | Default |
| :-------- | :--------------------- | :----- | :------------------- | :------ |
| method    | request method         | string | get , post , put ... | get     |
| params    | url request parameters | object | --                   | --      |
| data      | Submitted data         | any    | --                   | --      |
| ...       |

See more on [umi-request](https://github.com/umijs/umi-request)
